<?php
/**
 * Created by PhpStorm.
 * User: 2m
 * Date: 2016/11/10
 * Time: 下午4:36
 */

namespace app\filters;

use app\controllers\PrivilegeController;
use yii\base\ActionFilter;

class PrivilegeFilter extends ActionFilter
{
    public $privilege;

    public function beforeAction($action)
    {
        parent::beforeAction($action); // TODO: Change the autogenerated stub

        if(is_array($this->privilege))
        {
            $id = $action->id;

			if(PrivilegeController::has($this->privilege[$id])){
				return true;
			}

			\Yii::$app->response->headers->add('status',403);
			return false;

		}else{
			if(PrivilegeController::has($this->privilege)){
				return true;
			}

			\Yii::$app->response->headers->add('status',403);
			return false;

		}
    }
}